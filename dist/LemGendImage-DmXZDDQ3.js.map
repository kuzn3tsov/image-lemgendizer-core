{"version":3,"file":"LemGendImage-DmXZDDQ3.js","sources":["../src/LemGendImage.js"],"sourcesContent":["/**\r\n * LemGendImage - Core image representation class\r\n * @class\r\n * @description Represents an image throughout the processing pipeline\r\n */\r\n\r\n// Import utility functions\r\nimport {\r\n    getImageDimensions,\r\n    hasTransparency,\r\n    createThumbnail,\r\n    analyzeForOptimization,\r\n    formatFileSize,\r\n    getFileExtension,\r\n    fileToDataURL\r\n} from './utils/imageUtils.js';\r\n\r\nexport class LemGendImage {\r\n    /**\r\n     * Create a new LemGendImage instance\r\n     * @param {File} file - The original image file\r\n     * @param {Object} options - Configuration options\r\n     */\r\n    constructor(file, options = {}) {\r\n        if (!(file instanceof File)) {\r\n            throw new TypeError('LemGendImage requires a File object')\r\n        }\r\n\r\n        this.id = `lemgend_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n        this.file = file\r\n        this.originalName = file.name\r\n        this.originalSize = file.size\r\n        this.type = file.type\r\n        this.mimeType = file.type\r\n        this.extension = getFileExtension(file)\r\n\r\n        if (this.extension === 'ico' && !this.type.includes('image')) {\r\n            this.type = 'image/x-icon'\r\n            this.mimeType = 'image/x-icon'\r\n        }\r\n\r\n        this.metadata = {\r\n            originalDimensions: null,\r\n            processedDimensions: null,\r\n            operations: [],\r\n            createdAt: new Date().toISOString(),\r\n            lastModified: new Date().toISOString(),\r\n            optimizationHistory: [],\r\n            analysis: null\r\n        }\r\n        this.outputs = new Map()\r\n        this.processed = false\r\n        this.orientation = options.orientation || null\r\n        this.width = options.width || null\r\n        this.height = options.height || null\r\n        this.aspectRatio = null\r\n        this.transparency = null\r\n        this._imageElement = null\r\n        this._svgDocument = null\r\n        this._objectURL = null\r\n        this.optimizationScore = 0\r\n        this.optimizationRecommendations = []\r\n\r\n        if (this.width && this.height) {\r\n            this.aspectRatio = this.width / this.height\r\n            this.orientation = this.width >= this.height ? 'landscape' : 'portrait'\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load and analyze the image\r\n     * @returns {Promise<LemGendImage>} The loaded image instance\r\n     */\r\n    load = async () => {\r\n        try {\r\n            if (this.type === 'image/svg+xml') {\r\n                await this._loadSVG()\r\n            } else if (this.type === 'image/x-icon' || this.type === 'image/vnd.microsoft.icon') {\r\n                await this._loadFavicon()\r\n            } else {\r\n                await this._loadRaster()\r\n            }\r\n\r\n            if (this.width && this.height) {\r\n                this.aspectRatio = this.width / this.height\r\n                this.orientation = this.width >= this.height ? 'landscape' : 'portrait'\r\n            }\r\n\r\n            this.metadata.originalDimensions = {\r\n                width: this.width,\r\n                height: this.height,\r\n                orientation: this.orientation,\r\n                aspectRatio: this.aspectRatio\r\n            }\r\n\r\n            // Analyze image for optimization using utility function\r\n            const analysis = await analyzeForOptimization(this.file)\r\n            this.optimizationScore = analysis.optimizationScore\r\n            this.optimizationRecommendations = analysis.recommendations\r\n            this.metadata.analysis = analysis\r\n            this.metadata.optimizationLevel = analysis.optimizationLevel\r\n\r\n            // Check transparency if applicable\r\n            if (this.type === 'image/png' || this.type === 'image/webp' || this.type.includes('icon')) {\r\n                this.transparency = await hasTransparency(this.file)\r\n            }\r\n\r\n            return this\r\n        } catch (error) {\r\n            throw new Error(`Failed to load image: ${error.message}`)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load and analyze favicon (ICO) file\r\n     * @private\r\n     */\r\n    _loadFavicon = async () => {\r\n        try {\r\n            this.width = 32\r\n            this.height = 32\r\n            this.aspectRatio = 1\r\n            this.orientation = 'square'\r\n\r\n            this.metadata.favicon = true\r\n            this.metadata.possibleSizes = [16, 32, 48, 64, 128, 256]\r\n\r\n            return this\r\n        } catch (error) {\r\n            throw new Error(`Failed to load favicon: ${error.message}`)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load and analyze SVG image\r\n     * @private\r\n     */\r\n    _loadSVG = async () => {\r\n        try {\r\n            const text = await this.file.text()\r\n            const parser = new DOMParser()\r\n            const svgDoc = parser.parseFromString(text, 'image/svg+xml')\r\n            const svgElement = svgDoc.documentElement\r\n\r\n            const parserError = svgDoc.querySelector('parsererror')\r\n            if (parserError) {\r\n                throw new Error('Invalid SVG format')\r\n            }\r\n\r\n            const widthAttr = svgElement.getAttribute('width')\r\n            const heightAttr = svgElement.getAttribute('height')\r\n            const viewBox = svgElement.getAttribute('viewBox')\r\n\r\n            if (widthAttr && heightAttr) {\r\n                this.width = this._parseSVGLength(widthAttr)\r\n                this.height = this._parseSVGLength(heightAttr)\r\n            } else if (viewBox) {\r\n                const [x, y, vbWidth, vbHeight] = viewBox.split(/\\s+|,/).map(parseFloat)\r\n                this.width = vbWidth || 100\r\n                this.height = vbHeight || 100\r\n            } else {\r\n                this.width = 100\r\n                this.height = 100\r\n            }\r\n\r\n            this._svgDocument = svgDoc\r\n            this.metadata.svgContent = text\r\n            this.metadata.svgElement = svgElement\r\n            this.transparency = this._checkSVGTransparency(text)\r\n\r\n        } catch (error) {\r\n            throw new Error(`Failed to load SVG: ${error.message}`)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Parse SVG length string to pixels\r\n     * @private\r\n     */\r\n    _parseSVGLength = (lengthStr) => {\r\n        const match = lengthStr.match(/^([\\d.]+)(px|pt|pc|mm|cm|in|em|ex|%)?$/)\r\n        if (!match) return 100\r\n\r\n        const value = parseFloat(match[1])\r\n        const unit = match[2] || 'px'\r\n\r\n        const unitMap = {\r\n            'px': 1,\r\n            'pt': 1.33,\r\n            'pc': 16,\r\n            'mm': 3.78,\r\n            'cm': 37.8,\r\n            'in': 96,\r\n            'em': 16,\r\n            'ex': 8,\r\n            '%': value\r\n        }\r\n\r\n        return value * (unitMap[unit] || 1)\r\n    }\r\n\r\n    /**\r\n     * Check if SVG has transparent elements\r\n     * @private\r\n     */\r\n    _checkSVGTransparency = (svgText) => {\r\n        const transparencyIndicators = [\r\n            'fill=\"none\"',\r\n            'fill=\"transparent\"',\r\n            'fill-opacity',\r\n            'opacity=',\r\n            'rgba(',\r\n            'hsla(',\r\n            'fill:#00000000',\r\n            'fill:transparent',\r\n            'stroke-opacity',\r\n            'stop-opacity'\r\n        ]\r\n\r\n        return transparencyIndicators.some(indicator =>\r\n            svgText.includes(indicator)\r\n        )\r\n    }\r\n\r\n    /**\r\n     * Load and analyze raster image\r\n     * @private\r\n     */\r\n    _loadRaster = async () => {\r\n        return new Promise((resolve, reject) => {\r\n            const img = new Image()\r\n\r\n            img.onload = () => {\r\n                this.width = img.naturalWidth || img.width\r\n                this.height = img.naturalHeight || img.height\r\n                this._imageElement = img\r\n                this._objectURL = img.src\r\n                resolve(this)\r\n            }\r\n\r\n            img.onerror = () => {\r\n                reject(new Error('Failed to load raster image'))\r\n            }\r\n\r\n            img.src = URL.createObjectURL(this.file)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Update image dimensions\r\n     * @param {number} width - New width in pixels\r\n     * @param {number} height - New height in pixels\r\n     */\r\n    updateDimensions = (width, height) => {\r\n        if (typeof width !== 'number' || typeof height !== 'number' || width <= 0 || height <= 0) {\r\n            throw new Error('Dimensions must be positive numbers')\r\n        }\r\n\r\n        this.width = width\r\n        this.height = height\r\n        this.aspectRatio = width / height\r\n        this.orientation = width >= height ? 'landscape' : 'portrait'\r\n\r\n        this.metadata.processedDimensions = { width, height, aspectRatio: this.aspectRatio }\r\n        this.metadata.lastModified = new Date().toISOString()\r\n    }\r\n\r\n    /**\r\n     * Add an operation to metadata\r\n     * @param {string} operation - Operation name\r\n     * @param {Object} details - Operation details\r\n     */\r\n    addOperation = (operation, details) => {\r\n        this.metadata.operations.push({\r\n            operation,\r\n            details,\r\n            timestamp: new Date().toISOString(),\r\n            previousDimensions: this.metadata.processedDimensions || this.metadata.originalDimensions\r\n        })\r\n\r\n        // Track optimization operations separately\r\n        if (operation === 'optimize') {\r\n            this.metadata.optimizationHistory.push({\r\n                ...details,\r\n                timestamp: new Date().toISOString()\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add processed output\r\n     * @param {string} format - Output format\r\n     * @param {File} file - Processed file\r\n     * @param {Object} template - Template used (if any)\r\n     */\r\n    addOutput = (format, file, template = null) => {\r\n        if (!(file instanceof File)) {\r\n            throw new TypeError('Output must be a File object')\r\n        }\r\n\r\n        this.outputs.set(format, {\r\n            file,\r\n            format,\r\n            template,\r\n            dimensions: { width: this.width, height: this.height },\r\n            size: file.size,\r\n            addedAt: new Date().toISOString()\r\n        })\r\n\r\n        this.processed = true\r\n    }\r\n\r\n    /**\r\n     * Get output by format\r\n     * @param {string} format - Output format\r\n     * @returns {Object|null} Output object or null\r\n     */\r\n    getOutput = (format) => {\r\n        return this.outputs.get(format) || null\r\n    }\r\n\r\n    /**\r\n     * Get all outputs\r\n     * @returns {Array} Array of output objects\r\n     */\r\n    getAllOutputs = () => {\r\n        return Array.from(this.outputs.values())\r\n    }\r\n\r\n    /**\r\n     * Get output as Data URL\r\n     * @param {string} format - Output format\r\n     * @returns {Promise<string>} Data URL\r\n     */\r\n    getOutputAsDataURL = async (format) => {\r\n        const output = this.getOutput(format)\r\n        if (!output) {\r\n            throw new Error(`No output found for format: ${format}`)\r\n        }\r\n\r\n        return fileToDataURL(output.file)\r\n    }\r\n\r\n    /**\r\n     * Get original image as Data URL\r\n     * @returns {Promise<string>} Data URL\r\n     */\r\n    toDataURL = async () => {\r\n        return fileToDataURL(this.file)\r\n    }\r\n\r\n    /**\r\n     * Get optimization recommendations based on image analysis\r\n     * @returns {Object} Optimization recommendations\r\n     */\r\n    getOptimizationRecommendations = () => {\r\n        const recommendations = {\r\n            format: this._recommendFormat(),\r\n            quality: this._recommendQuality(),\r\n            resize: this._recommendResize(),\r\n            warnings: this.optimizationRecommendations,\r\n            suggestions: [],\r\n            priority: this._getOptimizationPriority()\r\n        }\r\n\r\n        // Additional suggestions based on image characteristics\r\n        if (this.transparency && this.extension === 'jpg') {\r\n            recommendations.suggestions.push('JPEG format does not support transparency - consider PNG or WebP')\r\n        }\r\n\r\n        if (this.width > 4000 || this.height > 4000) {\r\n            recommendations.suggestions.push('Image dimensions very large - consider resizing for web')\r\n        }\r\n\r\n        if (this.originalSize > 10 * 1024 * 1024) {\r\n            recommendations.suggestions.push('Image is very large (>10MB) - consider aggressive compression')\r\n        }\r\n\r\n        return recommendations\r\n    }\r\n\r\n    /**\r\n     * Recommend best format based on image characteristics\r\n     * @private\r\n     */\r\n    _recommendFormat = () => {\r\n        if (this.type === 'image/svg+xml') return 'svg'\r\n        if (this.type.includes('icon')) return 'ico'\r\n\r\n        if (this.transparency) {\r\n            return 'webp' // WebP supports transparency and has good compression\r\n        }\r\n\r\n        // For photographic images, recommend modern formats\r\n        if (this.width * this.height > 1000000) {\r\n            return 'avif' // AVIF is great for large images\r\n        }\r\n\r\n        return 'webp' // Default to WebP for good balance\r\n    }\r\n\r\n    /**\r\n     * Recommend quality setting\r\n     * @private\r\n     */\r\n    _recommendQuality = () => {\r\n        if (this.type === 'image/svg+xml' || this.type.includes('icon')) {\r\n            return 100 // Vector and icons should be lossless\r\n        }\r\n\r\n        if (this.transparency) {\r\n            return 90 // Higher quality for transparency\r\n        }\r\n\r\n        if (this.width * this.height > 2000000) {\r\n            return 80 // Lower quality for very large images\r\n        }\r\n\r\n        return 85 // Default good quality\r\n    }\r\n\r\n    /**\r\n     * Recommend resize dimensions\r\n     * @private\r\n     */\r\n    _recommendResize = () => {\r\n        const maxWebDimension = 1920\r\n\r\n        if (this.width <= maxWebDimension && this.height <= maxWebDimension) {\r\n            return null // No resize needed\r\n        }\r\n\r\n        let newWidth, newHeight\r\n\r\n        if (this.width >= this.height) {\r\n            newWidth = Math.min(this.width, maxWebDimension)\r\n            newHeight = Math.round((this.height / this.width) * newWidth)\r\n        } else {\r\n            newHeight = Math.min(this.height, maxWebDimension)\r\n            newWidth = Math.round((this.width / this.height) * newHeight)\r\n        }\r\n\r\n        return {\r\n            width: newWidth,\r\n            height: newHeight,\r\n            reason: `Resize to ${newWidth}x${newHeight} for web display`\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get optimization priority\r\n     * @private\r\n     */\r\n    _getOptimizationPriority = () => {\r\n        const megapixels = (this.width * this.height) / 1000000\r\n        const mbSize = this.originalSize / (1024 * 1024)\r\n\r\n        if (mbSize > 10 || megapixels > 16) {\r\n            return 'high' // Very large images need optimization\r\n        }\r\n\r\n        if (mbSize > 2 || megapixels > 4) {\r\n            return 'medium' // Large images benefit from optimization\r\n        }\r\n\r\n        return 'low' // Small images are already fairly optimized\r\n    }\r\n\r\n    /**\r\n     * Get optimization summary for reporting\r\n     * @returns {Object} Optimization summary\r\n     */\r\n    getOptimizationSummary = () => {\r\n        const recommendations = this.getOptimizationRecommendations()\r\n\r\n        return {\r\n            original: {\r\n                name: this.originalName,\r\n                size: this.originalSize,\r\n                dimensions: `${this.width}x${this.height}`,\r\n                format: this.extension,\r\n                hasTransparency: this.transparency,\r\n                mimeType: this.type\r\n            },\r\n            recommendations,\r\n            estimatedSavings: this._estimateOptimizationSavings(recommendations),\r\n            priority: recommendations.priority,\r\n            optimizationScore: this.optimizationScore,\r\n            optimizationLevel: this.metadata.optimizationLevel || 'unknown'\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Estimate optimization savings\r\n     * @private\r\n     */\r\n    _estimateOptimizationSavings = (recommendations) => {\r\n        // Simple estimation based on format and quality\r\n        let estimatedSize = this.originalSize\r\n\r\n        switch (recommendations.format) {\r\n            case 'webp':\r\n                estimatedSize *= 0.7\r\n                break\r\n            case 'avif':\r\n                estimatedSize *= 0.6\r\n                break\r\n            case 'png':\r\n                estimatedSize *= 0.9\r\n                break\r\n            case 'jpg':\r\n                estimatedSize *= 0.8\r\n                break\r\n            case 'svg':\r\n                estimatedSize *= 0.3\r\n                break\r\n        }\r\n\r\n        // Apply quality adjustment\r\n        estimatedSize *= (recommendations.quality / 100)\r\n\r\n        // Apply resize if recommended\r\n        if (recommendations.resize) {\r\n            const areaReduction = (recommendations.resize.width * recommendations.resize.height) /\r\n                (this.width * this.height)\r\n            estimatedSize *= areaReduction\r\n        }\r\n\r\n        const savings = this.originalSize - estimatedSize\r\n\r\n        return {\r\n            originalSize: this.originalSize,\r\n            estimatedSize: Math.round(estimatedSize),\r\n            savings: Math.round(savings),\r\n            savingsPercent: Math.round((savings / this.originalSize) * 1000) / 10\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get image info summary\r\n     * @returns {Object} Image information\r\n     */\r\n    getInfo = () => {\r\n        return {\r\n            id: this.id,\r\n            name: this.originalName,\r\n            type: this.type,\r\n            originalSize: this.originalSize,\r\n            width: this.width,\r\n            height: this.height,\r\n            orientation: this.orientation,\r\n            aspectRatio: this.aspectRatio,\r\n            transparency: this.transparency,\r\n            processed: this.processed,\r\n            outputs: this.getAllOutputs().map(output => output.format),\r\n            metadata: { ...this.metadata },\r\n            optimization: {\r\n                score: this.optimizationScore,\r\n                level: this.metadata.optimizationLevel,\r\n                recommendations: this.optimizationRecommendations.length\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get detailed optimization report\r\n     * @returns {Object} Detailed optimization report\r\n     */\r\n    getOptimizationReport = () => {\r\n        const summary = this.getOptimizationSummary()\r\n        const info = this.getInfo()\r\n\r\n        return {\r\n            ...summary,\r\n            imageInfo: {\r\n                id: info.id,\r\n                name: info.name,\r\n                type: info.type,\r\n                processed: info.processed\r\n            },\r\n            analysis: this.metadata.analysis,\r\n            optimizationHistory: this.metadata.optimizationHistory,\r\n            generatedAt: new Date().toISOString()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if image needs optimization\r\n     * @param {number} threshold - Optimization score threshold (0-100)\r\n     * @returns {boolean} True if optimization needed\r\n     */\r\n    needsOptimization = (threshold = 30) => {\r\n        return this.optimizationScore >= threshold\r\n    }\r\n\r\n    /**\r\n     * Get recommended optimization settings\r\n     * @param {string} useCase - Use case identifier\r\n     * @returns {Object} Recommended settings\r\n     */\r\n    getRecommendedSettings = (useCase = 'web') => {\r\n        const recommendations = this.getOptimizationRecommendations()\r\n\r\n        const presets = {\r\n            'web': {\r\n                quality: recommendations.quality,\r\n                format: recommendations.format,\r\n                maxDisplayWidth: 1920,\r\n                compressionMode: 'adaptive',\r\n                browserSupport: ['modern', 'legacy']\r\n            },\r\n            'social': {\r\n                quality: 90,\r\n                format: 'jpg',\r\n                maxDisplayWidth: 1080,\r\n                compressionMode: 'balanced',\r\n                stripMetadata: false\r\n            },\r\n            'ecommerce': {\r\n                quality: 92,\r\n                format: 'webp',\r\n                maxDisplayWidth: 1200,\r\n                compressionMode: 'balanced',\r\n                preserveTransparency: true\r\n            },\r\n            'print': {\r\n                quality: 100,\r\n                format: 'png',\r\n                maxDisplayWidth: null,\r\n                compressionMode: 'balanced',\r\n                lossless: true\r\n            }\r\n        }\r\n\r\n        return presets[useCase] || presets['web']\r\n    }\r\n\r\n    /**\r\n     * Create thumbnail preview - uses utility function\r\n     * @param {number} maxSize - Maximum thumbnail dimension\r\n     * @returns {Promise<string>} Thumbnail as Data URL\r\n     */\r\n    createThumbnail = async (maxSize = 200) => {\r\n        return createThumbnail(this, maxSize)\r\n    }\r\n\r\n    /**\r\n     * Clean up resources\r\n     */\r\n    destroy = () => {\r\n        if (this._objectURL) {\r\n            URL.revokeObjectURL(this._objectURL)\r\n        }\r\n\r\n        if (this._imageElement?.src && this._imageElement.src.startsWith('blob:')) {\r\n            URL.revokeObjectURL(this._imageElement.src)\r\n        }\r\n\r\n        this._imageElement = null\r\n        this._svgDocument = null\r\n        this._objectURL = null\r\n        this.outputs.clear()\r\n    }\r\n\r\n    /**\r\n     * Clone the image instance (without outputs)\r\n     * @returns {LemGendImage} Cloned instance\r\n     */\r\n    clone = () => {\r\n        const clone = new LemGendImage(this.file, {\r\n            orientation: this.orientation,\r\n            width: this.width,\r\n            height: this.height\r\n        })\r\n\r\n        clone.metadata = JSON.parse(JSON.stringify(this.metadata))\r\n        clone.transparency = this.transparency\r\n        clone.aspectRatio = this.aspectRatio\r\n        clone.optimizationScore = this.optimizationScore\r\n        clone.optimizationRecommendations = [...this.optimizationRecommendations]\r\n\r\n        return clone\r\n    }\r\n}"],"names":[],"mappings":"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"}