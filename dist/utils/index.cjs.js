"use strict";var K=Object.create;var R=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var ie=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var oe=(t,a,o,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let i of te(a))!ae.call(t,i)&&i!==o&&R(t,i,{get:()=>a[i],enumerable:!(e=ee(a,i))||e.enumerable});return t};var v=(t,a,o)=>(o=t!=null?K(ie(t)):{},oe(a||!t||!t.__esModule?R(o,"default",{value:t,enumerable:!0}):o,t));Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=require("../validation-DU-FiGJX.cjs");async function F(t=[],a={}){const e={...{includeOriginal:!0,includeOptimized:!0,includeWebImages:!0,includeLogoImages:!0,includeFaviconImages:!0,includeSocialMedia:!0,createFolders:!0,includeInfoFile:!0,zipName:"lemgendary-export",skipEmptyFolders:!0},...a};let i;try{i=(await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js")).default}catch{throw new Error("JSZip library required. Include it via CDN or npm package.")}const n=new i,r=new Date,s=r.toISOString().replace(/[:.]/g,"-").split("T")[0],c=`${e.zipName}-${s}`,l=e.createFolders?n.folder(c):n,m=[{name:"00_Originals",condition:e.includeOriginal,files:await D(t)},{name:"01_Optimized",condition:e.includeOptimized,files:await C(t,"optimized")},{name:"02_Web_Images",condition:e.includeWebImages,files:await w(t,"web")},{name:"03_Logo_Images",condition:e.includeLogoImages,files:await w(t,"logo")},{name:"04_Favicon_Images",condition:e.includeFaviconImages,files:await w(t,"favicon")},{name:"05_Social_Media",condition:e.includeSocialMedia,files:await w(t,"social")}];for(const g of m)if(g.condition&&g.files.length>0){const d=e.createFolders?l.folder(g.name):l;for(const h of g.files){const b=z(h.name);d.file(b,h.content)}}else g.condition&&g.files.length===0&&e.skipEmptyFolders&&console.log(`Skipping empty folder: ${g.name}`);if(e.includeInfoFile){const g=ne(t,e);l.file("INFO.txt",g)}return await n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6},comment:`Created by LemGendary Image Processor - ${r.toISOString()}`,platform:"UNIX"})}async function D(t){const a=[];for(const o of t)o.file&&o.file instanceof File&&a.push({name:o.originalName||o.file.name,content:o.file});return a}async function C(t,a){const o=[];for(const e of t){let i=[];typeof e.getAllOutputs=="function"?i=e.getAllOutputs():e.outputs&&typeof e.outputs.get=="function"?i=Array.from(e.outputs.values()):Array.isArray(e.outputs)&&(i=e.outputs);const n=i.filter(r=>!r.template||r.template==="custom"||r.category===a);for(const r of n)r.file&&r.file instanceof File&&o.push({name:r.file.name||`optimized-${Date.now()}.${x(r.file)}`,content:r.file})}return o}async function w(t,a){const o=[];for(const e of t){let i=[];typeof e.getAllOutputs=="function"?i=e.getAllOutputs():e.outputs&&typeof e.outputs.get=="function"?i=Array.from(e.outputs.values()):Array.isArray(e.outputs)&&(i=e.outputs);const n=i.filter(r=>(r.template?.category||r.category||"").toLowerCase()===a.toLowerCase());for(const r of n)r.file&&r.file instanceof File&&o.push({name:r.file.name||`${a}-${Date.now()}.${x(r.file)}`,content:r.file})}return o}function ne(t,a){const o=new Date,e={totalImages:t.length,originals:0,optimized:0,web:0,logo:0,favicon:0,social:0,formats:{},totalSize:0};for(const n of t){n.file&&(e.originals++,e.totalSize+=n.file.size||0);let r=[];typeof n.getAllOutputs=="function"?r=n.getAllOutputs():n.outputs&&Array.isArray(n.outputs)&&(r=n.outputs);for(const s of r)if(s.file){switch(e.totalSize+=s.file.size||0,(s.template?.category||s.category||"optimized").toLowerCase()){case"web":e.web++;break;case"logo":e.logo++;break;case"favicon":e.favicon++;break;case"social":e.social++;break;default:e.optimized++}const l=x(s.file);e.formats[l]=(e.formats[l]||0)+1}}return`LEMGENDARY IMAGE EXPORT
===========================

Export Information
------------------
Date: ${o.toLocaleDateString()} ${o.toLocaleTimeString()}
Tool: LemGendary Image Processor
Version: 2.0.0
Export ID: ${Date.now().toString(36).toUpperCase()}

Options Used
------------
${Object.entries(a).filter(([n])=>!["zipName"].includes(n)).map(([n,r])=>`${n.padEnd(20)}: ${r}`).join(`
`)}

Statistics
----------
Total Images Processed: ${e.totalImages}
Total Files in Export: ${e.originals+e.optimized+e.web+e.logo+e.favicon+e.social}

File Breakdown:
  Original Images: ${e.originals}
  Optimized Images: ${e.optimized}
  Web Images: ${e.web}
  Logo Images: ${e.logo}
  Favicon Images: ${e.favicon}
  Social Media Images: ${e.social}

Format Distribution:
${Object.entries(e.formats).map(([n,r])=>`  ${n.toUpperCase().padEnd(6)}: ${r} files`).join(`
`)}

Total Size: ${U(e.totalSize)}

Image Details
-------------
${t.map((n,r)=>{const s=typeof n.getAllOutputs=="function"?n.getAllOutputs():[];return`[${r+1}] ${n.originalName||"Unnamed"}
  Original: ${U(n.originalSize||0)} | ${n.width||"?"}×${n.height||"?"}
  Outputs: ${s.length} file(s)
  ${s.map(c=>`  - ${c.file?.name||"Unnamed"} (${c.template?.category||"custom"})`).join(`
  `)}`}).join(`

`)}

Folder Structure
----------------
${a.createFolders?`
00_Originals/       - Original uploaded images (${e.originals>0?e.originals+" files":"Skipped - empty"})
01_Optimized/       - Custom processed images (${e.optimized>0?e.optimized+" files":"Skipped - empty"})
02_Web_Images/      - Web template outputs (${e.web>0?e.web+" files":"Skipped - empty"})
03_Logo_Images/     - Logo template outputs (${e.logo>0?e.logo+" files":"Skipped - empty"})
04_Favicon_Images/  - Favicon template outputs (${e.favicon>0?e.favicon+" files":"Skipped - empty"})
05_Social_Media/    - Social media platform outputs (${e.social>0?e.social+" files":"Skipped - empty"})`:"All files in root folder"}

Notes
-----
• All processing done client-side in browser
• No images uploaded to external servers
• Created with LemGendary Image Processor
• https://github.com/lemgenda/image-lemgendizer`}function U(t,a=2){if(t===0)return"0 Bytes";const o=1024,e=a<0?0:a,i=["Bytes","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(o));return parseFloat((t/Math.pow(o,n)).toFixed(e))+" "+i[n]}function x(t){if(!t||!t.name)return"unknown";const a=t.name.split(".");return a.length>1?a.pop().toLowerCase():{"image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/bmp":"bmp","image/tiff":"tiff","image/x-icon":"ico","image/avif":"avif"}[t.type]||"unknown"}function z(t){return t?t.replace(/[<>:"/\\|?*]/g,"-").replace(/\s+/g,"_").replace(/[^\w.\-]/g,"").substring(0,255).trim():"unnamed-file"}async function E(t=[],a="files"){let o;try{o=(await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js")).default}catch{throw new Error("JSZip library required. Include it via CDN or npm package.")}const e=new o;for(const i of t)i&&i instanceof File&&e.file(z(i.name),i);return e.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})}async function A(t){if(!(t instanceof Blob))throw new Error("Input must be a Blob object");let a;try{a=(await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js")).default}catch{throw new Error("JSZip library required. Include it via CDN or npm package.")}const o=await a.loadAsync(t),e=[],i=Object.keys(o.files).map(async n=>{const r=o.files[n];if(!r.dir)try{const s=await r.async("blob"),c=re(n),l=new File([s],n,{type:c,lastModified:r.date?r.date.getTime():Date.now()});e.push({name:n,file:l,size:s.size,type:l.type,path:n.includes("/")?n.split("/").slice(0,-1).join("/"):"",lastModified:r.date})}catch(s){console.warn(`Failed to extract file ${n}:`,s)}});return await Promise.all(i),e}function re(t){const a=t.toLowerCase().split(".").pop();return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",svg:"image/svg+xml",bmp:"image/bmp",ico:"image/x-icon",tiff:"image/tiff",tif:"image/tiff",avif:"image/avif",pdf:"application/pdf",txt:"text/plain",csv:"text/csv",json:"application/json",xml:"application/xml",zip:"application/zip",rar:"application/vnd.rar","7z":"application/x-7z-compressed","":"application/octet-stream"}[a]||"application/octet-stream"}async function k(t){if(!(t instanceof Blob))throw new Error("Input must be a Blob object");let a;try{a=(await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js")).default}catch{throw new Error("JSZip library required. Include it via CDN or npm package.")}const o=await a.loadAsync(t),e=[];let i=0,n=0,r=0;return Object.keys(o.files).forEach(s=>{const c=o.files[s];if(c.dir)r++;else{n++;const l=c._data.uncompressedSize||0;i+=l,e.push({name:s,size:l,compressedSize:c._data.compressedSize||0,compressed:c._data.compression!==null,directory:!1,lastModified:c.date,ratio:l>0?((l-c._data.compressedSize)/l*100).toFixed(1):0})}}),{fileCount:n,folderCount:r,totalSize:i,compressedSize:t.size,compressionRatio:i>0?t.size/i:0,files:e,comment:o.comment||"",format:"ZIP",isEncrypted:o.password!==null,timestamp:new Date().toISOString()}}async function P(t,a={},o=null){let e;try{e=(await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js")).default}catch{throw new Error("JSZip library required. Include it via CDN or npm package.")}const i=new e,n=a.zipName||`export-${Date.now()}`,r=a.createFolders?i.folder(n):i,s=se(t,a);let c=0;if(a.includeOriginal){const m=await D(t);for(const p of m)r.file(z(p.name),p.content),c++,o&&o(c/s,`Adding ${p.name}`)}const l=[{name:"optimized",getter:C},{name:"web",getter:m=>w(m,"web")},{name:"logo",getter:m=>w(m,"logo")},{name:"favicon",getter:m=>w(m,"favicon")},{name:"social",getter:m=>w(m,"social")}];for(const m of l)if(a[`include${m.name.charAt(0).toUpperCase()+m.name.slice(1)}`]){const p=await m.getter(t),g=a.createFolders?r.folder(ce(m.name)):r;for(const d of p)g.file(z(d.name),d.content),c++,o&&o(c/s,`Adding ${m.name}: ${d.name}`)}return i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},m=>{if(o){const p=c/s,g=m.percent/100,d=p*.5+g*.5;o(d,`Compressing (${m.percent.toFixed(1)}%)`)}})}function se(t,a){let o=0;a.includeOriginal&&(o+=t.filter(e=>e.file).length);for(const e of t){let i=[];typeof e.getAllOutputs=="function"?i=e.getAllOutputs():Array.isArray(e.outputs)&&(i=e.outputs);for(const n of i){const r=n.template?.category||n.category||"optimized",s=`include${r.charAt(0).toUpperCase()+r.slice(1)}`;a[s]!==!1&&o++}}return Math.max(o,1)}function ce(t){return{optimized:"01_Optimized",web:"02_Web_Images",logo:"03_Logo_Images",favicon:"04_Favicon_Images",social:"05_Social_Media"}[t]||t}async function T(t,a={}){const o=t.filter(i=>i.success&&i.image).map(i=>i.image),e={...a,includeWebImages:!1,includeLogoImages:!1,includeFaviconImages:!1,includeSocialMedia:!1,zipName:a.zipName||"custom-processed"};return F(o,e)}async function N(t,a={}){const o=t.filter(i=>i.success&&i.image).map(i=>i.image),e={...a,zipName:a.zipName||"template-export"};return F(o,e)}const le={createLemGendaryZip:F,createSimpleZip:E,extractZip:A,getZipInfo:k,createZipWithProgress:P,createCustomZip:T,createTemplateZip:N};async function O(t){return new Promise((a,o)=>{if(!t||!(t instanceof File)){o(new Error("Invalid file provided"));return}if(t.type==="image/x-icon"||t.type==="image/vnd.microsoft.icon"){pe().then(a).catch(()=>a({width:32,height:32,orientation:"square",aspectRatio:1}));return}const e=new Image,i=URL.createObjectURL(t);e.onload=()=>{const n={width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,orientation:e.naturalWidth>=e.naturalHeight?"landscape":"portrait",aspectRatio:e.naturalWidth/e.naturalHeight};URL.revokeObjectURL(i),a(n)},e.onerror=()=>{URL.revokeObjectURL(i),t.type==="image/svg+xml"?me(t).then(a).catch(()=>o(new Error("Failed to load image dimensions"))):o(new Error("Failed to load image"))},e.src=i})}async function me(t){return new Promise((a,o)=>{const e=new FileReader;e.onload=i=>{try{const n=i.target.result,s=new DOMParser().parseFromString(n,"image/svg+xml"),c=s.documentElement;if(s.querySelector("parsererror")){o(new Error("Invalid SVG format"));return}const l=parseFloat(c.getAttribute("width"))||c.viewBox?.baseVal?.width||100,m=parseFloat(c.getAttribute("height"))||c.viewBox?.baseVal?.height||100;a({width:l,height:m,orientation:l>=m?"landscape":"portrait",aspectRatio:l/m})}catch(n){o(n)}},e.onerror=o,e.readAsText(t)})}async function pe(t){return new Promise(a=>{a({width:32,height:32,orientation:"square",aspectRatio:1})})}async function M(t){return!t||t.type!=="image/png"&&t.type!=="image/webp"?!1:new Promise(a=>{const o=new Image,e=URL.createObjectURL(t);o.onload=()=>{const i=document.createElement("canvas");i.width=o.width,i.height=o.height;const n=i.getContext("2d");n.drawImage(o,0,0);const s=n.getImageData(0,0,i.width,i.height).data;for(let c=3;c<s.length;c+=4)if(s[c]<255){URL.revokeObjectURL(e),a(!0);return}URL.revokeObjectURL(e),a(!1)},o.onerror=()=>{URL.revokeObjectURL(e),a(!1)},o.src=e})}function _(t){return new Promise((a,o)=>{const e=new FileReader;e.onload=()=>a(e.result),e.onerror=o,e.readAsDataURL(t)})}function Z(t,a){return new Promise((o,e)=>{try{const i=t.split(","),n=i[0].match(/:(.*?);/)[1],r=atob(i[1]);let s=r.length;const c=new Uint8Array(s);for(;s--;)c[s]=r.charCodeAt(s);o(new File([c],a,{type:n}))}catch(i){e(i)}})}async function L(t,a,o,e="webp",i=.8){return new Promise((n,r)=>{if(e.toLowerCase()==="ico"){L(t,a,o,"png",i).then(l=>{console.warn("ICO format creation limited in browser. Using PNG instead."),n(l)}).catch(r);return}const s=new Image,c=URL.createObjectURL(t);s.onload=()=>{const l=document.createElement("canvas");l.width=a,l.height=o;const m=l.getContext("2d");(e==="jpg"||e==="jpeg")&&(m.fillStyle="#ffffff",m.fillRect(0,0,a,o)),m.drawImage(s,0,0,a,o);let p;switch(e.toLowerCase()){case"jpg":case"jpeg":p="image/jpeg";break;case"png":p="image/png";break;case"webp":p="image/webp";break;case"avif":p="image/avif";break;case"svg":p="image/svg+xml";break;default:p="image/webp"}l.toBlob(g=>{if(URL.revokeObjectURL(c),!g){r(new Error("Failed to create blob"));return}const d=e.toLowerCase(),b=`${t.name.replace(/\.[^/.]+$/,"")}-${a}x${o}.${d}`;n(new File([g],b,{type:p}))},p,i)},s.onerror=()=>{URL.revokeObjectURL(c),r(new Error("Failed to load image"))},s.src=c})}async function W(t,a,o,e,i,n="webp",r=.8){return new Promise((s,c)=>{const l=new Image,m=URL.createObjectURL(t);l.onload=()=>{const p=document.createElement("canvas");p.width=e,p.height=i;const g=p.getContext("2d");(n==="jpg"||n==="jpeg")&&(g.fillStyle="#ffffff",g.fillRect(0,0,e,i)),g.drawImage(l,a,o,e,i,0,0,e,i);let d;switch(n.toLowerCase()){case"jpg":case"jpeg":d="image/jpeg";break;case"png":d="image/png";break;case"webp":d="image/webp";break;default:d="image/webp"}p.toBlob(h=>{if(URL.revokeObjectURL(m),!h){c(new Error("Failed to create blob"));return}const b=n.toLowerCase(),X=`${t.name.replace(/\.[^/.]+$/,"")}-crop-${e}x${i}.${b}`;s(new File([h],X,{type:d}))},d,r)},l.onerror=()=>{URL.revokeObjectURL(m),c(new Error("Failed to load image"))},l.src=m})}function B(t,a,o,e="auto"){if(e==="width"){const i=o,n=Math.round(a/t*o);return{width:i,height:n}}else if(e==="height"){const i=o;return{width:Math.round(t/a*o),height:i}}else if(t>=a){const i=o,n=Math.round(a/t*o);return{width:i,height:n}}else{const i=o;return{width:Math.round(t/a*o),height:i}}}function f(t,a=2){if(t===0)return"0 Bytes";const o=1024,e=a<0?0:a,i=["Bytes","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(o));return parseFloat((t/Math.pow(o,n)).toFixed(e))+" "+i[n]}function y(t){if(t instanceof File){const e=t.name.split(".").pop().toLowerCase();return e&&e.length<=4?e:{"image/jpeg":"jpg","image/jpg":"jpg","image/png":"png","image/webp":"webp","image/gif":"gif","image/svg+xml":"svg","image/bmp":"bmp","image/tiff":"tiff","image/avif":"avif","image/x-icon":"ico","image/vnd.microsoft.icon":"ico"}[t.type]||"unknown"}const o=(typeof t=="string"?t:"").split(".").pop().toLowerCase();return o&&o.length<=4?o:"unknown"}function G(t){const a=[],o=[];if(!(t instanceof File))return a.push("Not a valid File object"),{valid:!1,errors:a,warnings:o};["image/jpeg","image/jpg","image/png","image/webp","image/gif","image/svg+xml","image/bmp","image/tiff","image/avif","image/x-icon","image/vnd.microsoft.icon"].includes(t.type)||a.push(`Unsupported file type: ${t.type}`);const i=50*1024*1024;return t.size>i?a.push(`File too large: ${f(t.size)} (max: ${f(i)})`):t.size>10*1024*1024&&o.push(`Large file: ${f(t.size)} - processing may be slow`),/[<>:"/\\|?*]/.test(t.name)&&o.push("Filename contains invalid characters"),{valid:a.length===0,errors:a,warnings:o}}async function I(t,a=200){return new Promise((o,e)=>{if(t.type==="image/x-icon"||t.type==="image/vnd.microsoft.icon"){o("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzM4ODJlZiIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNjAiIGZpbGw9IiNmZmYiLz48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjQwIiBmaWxsPSIjMzg4MmVmIi8+PC9zdmc+");return}const i=new Image,n=URL.createObjectURL(t);i.onload=()=>{let r,s;i.width>i.height?(r=a,s=Math.round(i.height/i.width*a)):(s=a,r=Math.round(i.width/i.height*a));const c=document.createElement("canvas");c.width=r,c.height=s,c.getContext("2d").drawImage(i,0,0,r,s);const m=c.toDataURL("image/jpeg",.7);URL.revokeObjectURL(n),o(m)},i.onerror=()=>{URL.revokeObjectURL(n),e(new Error("Failed to create thumbnail"))},i.src=n})}async function q(t,a,o){const e=[],i=t.length;for(let n=0;n<t.length;n++)try{const r=await a(t[n],n);e.push(r),o&&o((n+1)/i,n+1,i)}catch(r){console.error(`Error processing file ${n+1}:`,r),e.push({error:r.message,file:t[n]})}return e}async function $(t){const a=await O(t),o=await M(t),e={dimensions:a,transparency:o,fileSize:t.size,mimeType:t.type,extension:y(t),optimizationScore:0,recommendations:[]};let i=0;t.size>5*1024*1024?(i+=40,e.recommendations.push("File is very large - high optimization potential")):t.size>1*1024*1024?i+=20:t.size>100*1024&&(i+=10);const n=a.width*a.height/1e6;n>16?(i+=30,e.recommendations.push("Very high resolution - consider resizing")):n>4&&(i+=15);const r=["webp","avif","svg"],s=y(t);return r.includes(s)||(i+=20,e.recommendations.push(`Consider converting from ${s} to modern format`)),o&&s==="jpg"&&(i+=10,e.recommendations.push("JPEG with transparency - convert to PNG or WebP")),e.optimizationScore=Math.min(100,i),e.optimizationLevel=i>50?"high":i>25?"medium":"low",e}function V(t){const a={"web-high":{quality:85,format:"auto",maxDisplayWidth:1920,compressionMode:"balanced",stripMetadata:!0,description:"High quality web images"},"web-balanced":{quality:80,format:"auto",maxDisplayWidth:1200,compressionMode:"adaptive",stripMetadata:!0,description:"Balanced web images"},"web-aggressive":{quality:70,format:"webp",maxDisplayWidth:800,compressionMode:"aggressive",stripMetadata:!0,description:"Aggressive web optimization"},"social-media":{quality:90,format:"jpg",maxDisplayWidth:1080,compressionMode:"balanced",stripMetadata:!1,description:"Social media images"},ecommerce:{quality:92,format:"webp",maxDisplayWidth:1200,compressionMode:"balanced",stripMetadata:!0,preserveTransparency:!0,description:"E-commerce product images"},favicon:{quality:100,format:"ico",compressionMode:"balanced",icoSizes:[16,32,48,64],description:"Favicon generation"},"print-ready":{quality:100,format:"png",compressionMode:"balanced",lossless:!0,stripMetadata:!1,description:"Print-ready images"},"mobile-optimized":{quality:75,format:"webp",maxDisplayWidth:800,compressionMode:"aggressive",stripMetadata:!0,description:"Mobile-optimized images"}};return a[t]||a["web-balanced"]}function j(t,a){const{format:o,quality:e,maxDisplayWidth:i}=a;let n=t,r=[];switch(o){case"webp":n*=.7,r.push("WebP format: 30% reduction");break;case"avif":n*=.6,r.push("AVIF format: 40% reduction");break;case"jpg":n*=.8,r.push("JPEG format: 20% reduction");break;case"png":n*=.9,r.push("PNG format: 10% reduction");break;case"svg":n*=.3,r.push("SVG format: 70% reduction");break;default:n*=.75,r.push("Auto format selection: ~25% reduction")}const s=e/100;n*=s,r.push(`Quality ${e}%: ${Math.round((1-s)*100)}% reduction`),i&&(n*=.85,r.push(`Max width ${i}px: ~15% reduction`));const c=t-n,l=c/t*100;return{originalSize:t,estimatedSize:Math.round(n),savings:Math.round(c),savingsPercent:Math.round(l*10)/10,reductionFactors:r,readable:{original:f(t),estimated:f(Math.round(n)),savings:f(Math.round(c)),savingsPercent:`${Math.round(l*10)/10}%`}}}async function J(t,a){return new Promise((o,e)=>{const i=new Image;i.onload=()=>{try{const n=document.createElement("canvas"),r=n.getContext("2d"),s=400;let c=i.width,l=i.height;(c>s||l>s)&&(c>=l?(c=s,l=Math.round(i.height/i.width*s)):(l=s,c=Math.round(i.width/i.height*s))),n.width=c,n.height=l,r.drawImage(i,0,0,c,l);const m=Math.min(.7,a.quality/100*.8),p=n.toDataURL("image/jpeg",m);o(p)}catch(n){e(n)}},i.onerror=e,i.src=URL.createObjectURL(t)})}async function H(t,a){const o=t.size,e=a.size,i=o-e,n=i/o*100,r=await I(t,300),s=await I(a,300);return{original:{size:o,sizeFormatted:f(o),thumbnail:r},optimized:{size:e,sizeFormatted:f(e),thumbnail:s},savings:{bytes:i,percent:Math.round(n*10)/10,formatted:f(i),compressionRatio:(o/e).toFixed(2)},comparison:n>0?`Saved ${f(i)} (${Math.round(n)}%)`:"No savings achieved"}}function Y(t){const a=y(t);return!["webp","avif","svg"].includes(a)}function S(t){const a=y(t);return a==="svg"?"svg":a==="ico"?"ico":t.type==="image/png"||t.type==="image/webp"?"webp":t.size>2*1024*1024?"avif":"webp"}async function Q(t){const a=await $(t),o=S(t),e=j(t.size,{format:o,quality:85,maxDisplayWidth:1920});return{analysis:a,recommendedFormat:o,estimatedSavings:e,needsOptimization:a.optimizationScore>30,priority:a.optimizationLevel}}const ge={getImageDimensions:O,hasTransparency:M,fileToDataURL:_,dataURLtoFile:Z,resizeImage:L,cropImage:W,calculateAspectRatioFit:B,formatFileSize:f,getFileExtension:y,validateImageFile:G,createThumbnail:I,batchProcess:q,analyzeForOptimization:$,getOptimizationPreset:V,calculateOptimizationSavings:j,createOptimizationPreview:J,generateOptimizationComparison:H,needsFormatConversion:Y,getRecommendedFormat:S,getOptimizationStats:Q};exports.ValidationErrors=u.ValidationErrors;exports.ValidationWarnings=u.ValidationWarnings;exports.getFlexibleTemplates=u.getFlexibleTemplates;exports.getValidationSummary=u.getValidationSummary;exports.isVariableDimension=u.isVariableDimension;exports.parseDimension=u.parseDimension;exports.validateCrop=u.validateCrop;exports.validateDimensions=u.validateDimensions;exports.validateImage=u.validateImage;exports.validateOptimization=u.validateOptimization;exports.validateOptimizationOptions=u.validateOptimizationOptions;exports.validateRenamePattern=u.validateRenamePattern;exports.validateResize=u.validateResize;exports.validateTemplateCompatibility=u.validateTemplateCompatibility;exports.validation=u.validation;exports.analyzeForOptimization=$;exports.batchProcess=q;exports.calculateAspectRatioFit=B;exports.calculateOptimizationSavings=j;exports.createCustomZip=T;exports.createLemGendaryZip=F;exports.createOptimizationPreview=J;exports.createSimpleZip=E;exports.createTemplateZip=N;exports.createThumbnail=I;exports.createZipWithProgress=P;exports.cropImage=W;exports.dataURLtoFile=Z;exports.extractZip=A;exports.fileToDataURL=_;exports.formatFileSize=f;exports.generateOptimizationComparison=H;exports.getFileExtension=y;exports.getImageDimensions=O;exports.getOptimizationPreset=V;exports.getOptimizationStats=Q;exports.getRecommendedFormat=S;exports.getZipInfo=k;exports.hasTransparency=M;exports.imageUtils=ge;exports.needsFormatConversion=Y;exports.resizeImage=L;exports.validateImageFile=G;exports.zipUtils=le;
//# sourceMappingURL=index.cjs.js.map
